<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edutrack Assignment Tracker</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            margin-bottom: 30px;
            padding: 20px;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .user-info {
            display: flex;
            align-items: center;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 15px;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .nav-links {
            display: flex;
            gap: 20px;
        }
        
        .nav-links a {
            color: var(--dark);
            text-decoration: none;
            font-weight: 500;
            padding: 8px 12px;
            border-radius: 4px;
            transition: all 0.3s;
        }
        
        .nav-links a:hover {
            background-color: var(--light);
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .tab-container {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            background: white;
            border-radius: 8px;
            overflow-x: auto;
            padding: 10px;
        }
        
        .tab {
            padding: 12px 20px;
            border: 1px solid var(--light);
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .tab:hover {
            background-color: var(--light);
        }
        
        .tab.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            border-radius: 0 0 8px 8px;
            background: white;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .assignment-form {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        textarea {
            height: 100px;
        }
        
        .category-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .category-input {
            flex: 1;
        }
        
        .weight-input {
            width: 50px;
            text-align: center;
        }
        
        .grade-input {
            width: 50px;
        }
        
        .assignment-list {
            list-style: none;
        }
        
        .assignment-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .assignment-item:last-child {
            border-bottom: none;
        }
        
        .assignment-item .delete-btn {
            background: none;
            border: none;
            color: var(--danger);
            cursor: pointer;
            font-size: 1.2rem;
        }
        
        .assignment-item .delete-btn:hover {
            color: var(--danger);
        }
        
        .grade-display {
            font-weight: bold;
            font-size: 1.1rem;
            color: var(--primary);
        }
        
        .gpa-display {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            border-radius: 8px;
            padding: 20px;
            max-width: 800px;
            width: 90%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-title {
            font-size: 1.4rem;
            font-weight: 600;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: #666;
            font-size: 1.2rem;
            cursor: pointer;
        }
        
        .modal-body {
            display: flex;
            flex-direction: column;
        }
        
        .modal-row {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .modal-row label {
            flex: 1;
        }
        
        .modal-row input, .modal-row select {
            flex: 2;
        }
        
        .modal-row textarea {
            flex: 2;
            height: 100px;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
            border: none;
        }
        
        .btn-primary:hover {
            background-color: var(--secondary);
        }
        
        .btn-secondary {
            background-color: var(--light);
            color: var(--dark);
            border: 1px solid var(--light);
        }
        
        .btn-secondary:hover {
            background-color: #f0f2f5;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
            border: none;
        }
        
        .btn-danger:hover {
            background-color: #dc3545;
        }
        
        .supabase-auth {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .auth-form {
            display: flex;
            gap: 15px;
        }
        
        .auth-input {
            flex: 1;
        }
        
        .auth-btn {
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 500;
        }
        
        .auth-btn:hover {
            background-color: var(--secondary);
        }
        
        .error {
            color: var(--danger);
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .nav-links {
                margin-top: 10px;
            }
            
            .tab-container {
                flex-wrap: wrap;
            }
            
            .tab {
                min-width: 100px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo">Edutrack</div>
                <div class="user-info">
                    <div class="user-avatar">T</div>
                    <div class="nav-links">
                        <a href="#" class="btn btn-secondary">Dashboard</a>
                        <a href="#" class="btn btn-secondary">Settings</a>
                        <a href="#" class="btn btn-secondary">Logout</a>
                    </div>
                </div>
            </div>
        </header>
        
        <div class="tab-container" id="tab-container">
            <div class="tab active" data-tab="dashboard">Dashboard</div>
            <div class="tab" data-tab="classes">Classes</div>
            <div class="tab" data-tab="grades">Grades</div>
        </div>
        
        <div class="tab-content active" id="dashboard-content">
            <h2>Dashboard</h2>
            <p>Welcome to your Edutrack dashboard!</p>
        </div>
        
        <div class="tab-content" id="classes-content">
            <h2>Classes</h2>
            <div class="assignment-form">
                <h3>Add New Class</h3>
                <form id="class-form">
                    <div class="form-group">
                        <label for="className">Class Name</label>
                        <input type="text" id="className" placeholder="e.g. Math 101">
                    </div>
                    <div class="form-group">
                        <label for="classCode">Class Code</label>
                        <input type="text" id="classCode" placeholder="e.g. MATH101">
                    </div>
                    <div class="form-group">
                        <label for="classTeacher">Teacher</label>
                        <input type="text" id="classTeacher" placeholder="e.g. Dr. Smith">
                    </div>
                    <div class="form-group">
                        <label for="classTerm">Term</label>
                        <input type="text" id="classTerm" placeholder="e.g. Fall 2023">
                    </div>
                    <div class="form-group">
                        <label for="classYear">Year</label>
                        <input type="text" id="classYear" placeholder="e.g. 2023">
                    </div>
                    <div class="form-group">
                        <label for="classWeight">Total Weight</label>
                        <input type="number" id="classWeight" value="100" min="1" max="1000">
                    </div>
                    <div class="form-group">
                        <label for="classDescription">Description</label>
                        <textarea id="classDescription" placeholder="Class description..."></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Create Class</button>
                </form>
            </div>
            
            <div class="assignment-form">
                <h3>Assignments</h3>
                <div class="assignment-list" id="assignment-list">
                    <!-- Assignments will appear here -->
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="grades-content">
            <h2>Grades</h2>
            <div class="assignment-form">
                <h3>Grade Summary</h3>
                <div class="gpa-display">GPA: 3.75</div>
                <div class="grade-display">Overall Grade: A</div>
                <div class="grade-display">Class Average: 85%</div>
            </div>
        </div>
        
        <div class="supabase-auth">
            <h2>Login to Edutrack</h2>
            <div class="auth-form">
                <div class="auth-input">
                    <label for="email">Email</label>
                    <input type="email" id="email" placeholder="your@email.com">
                    <div class="error" id="email-error"></div>
                </div>
                <div class="auth-input">
                    <label for="password">Password</div>
                    <input type="password" id="password" placeholder="********">
                    <div class="error" id="password-error"></div>
                </div>
                <button type="button" class="btn btn-primary" id="login-btn">Login</button>
            </div>
        </div>
        
        <div class="modal" id="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">Add Assignment</div>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="modal-row">
                        <label for="assignmentName">Assignment Name</label>
                        <input type="text" id="assignmentName" placeholder="e.g. Midterm Exam">
                    </div>
                    <div class="modal-row">
                        <label for="assignmentDate">Due Date</label>
                        <input type="date" id="assignmentDate">
                    </div>
                    <div class="modal-row">
                        <label for="assignmentCategory">Category</label>
                        <select id="assignmentCategory">
                            <option value="">Select Category</option>
                            <!-- Categories will appear here -->
                        </select>
                    </div>
                    <div class="modal-row">
                        <label for="assignmentScore">Score</label>
                        <input type="number" id="assignmentScore" min="0" max="100">
                    </div>
                    <div class="modal-row">
                        <label for="assignmentMax">Max Points</label>
                        <input type="number" id="assignmentMax" value="100" min="1">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="cancel-btn">Cancel</button>
                    <button type="button" class="btn btn-primary" id="save-btn">Save Assignment</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Supabase configuration
        const supabaseUrl = 'https://njgjgpiamweujgyknqtz.supabase.co';
        const supabaseKey = 'sb_publishable_3bRvo_Zuppdi4ICnOtfjeA_VWfp6Zyx';
        const supabaseProject = 'Edutrack';
        
        // Initialize Supabase
        const supabase = createSupabase();
        
        // DOM elements
        const loginBtn = document.getElementById('login-btn');
        const modal = document.getElementById('modal');
        const closeBtn = document.querySelector('.close-btn');
        const saveBtn = document.getElementById('save-btn');
        const cancelBtn = document.getElementById('cancel-btn');
        const assignmentList = document.getElementById('assignment-list');
        const classForm = document.getElementById('class-form');
        const tabContainer = document.getElementById('tab-container');
        const tabs = document.querySelectorAll('.tab');
        
        // Initialize state
        let currentClassId = null;
        let currentTab = 'dashboard';
        
        // Initialize Supabase
        function createSupabase() {
            return new Supabase({
                url: supabaseUrl,
                key: supabaseKey,
                project: supabaseProject
            });
        }
        
        // Handle login
        loginBtn.addEventListener('click', async () => {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            try {
                const { data, error } = await supabase.auth.signIn({ email, password });
                
                if (error) {
                    document.getElementById('email-error').textContent = error.message;
                    document.getElementById('password-error').textContent = error.message;
                } else {
                    document.querySelector('.supabase-auth').style.display = 'none';
                    loadClasses();
                }
            } catch (error) {
                console.error('Error logging in:', error);
            }
        });
        
        // Close modal
        closeBtn.addEventListener('click', () => {
            modal.style.display = 'none';
        });
        
        // Cancel modal
        cancelBtn.addEventListener('click', () => {
            modal.style.display = 'none';
        });
        
        // Save assignment
        saveBtn.addEventListener('click', async () => {
            const assignmentName = document.getElementById('assignmentName').value;
            const assignmentDate = document.getElementById('assignmentDate').value;
            const assignmentCategory = document.getElementById('assignmentCategory').value;
            const assignmentScore = document.getElementById('assignmentScore').value;
            const assignmentMax = document.getElementById('assignmentMax').value;
            
            if (!assignmentName || !assignmentDate || !assignmentCategory || !assignmentScore || !assignmentMax) {
                alert('Please fill in all fields');
                return;
            }
            
            try {
                const { data, error } = await supabase
                    .from('assignments')
                    .insert([
                        {
                            class_id: currentClassId,
                            name: assignmentName,
                            due_date: assignmentDate,
                            category: assignmentCategory,
                            score: parseInt(assignmentScore),
                            max_points: parseInt(assignmentMax)
                        }
                    ]);
                
                if (error) {
                    console.error('Error saving assignment:', error);
                    alert('Error saving assignment');
                } else {
                    modal.style.display = 'none';
                    loadAssignments(currentClassId);
                }
            } catch (error) {
                console.error('Error saving assignment:', error);
                alert('Error saving assignment');
            }
        });
        
        // Load classes
        async function loadClasses() {
            try {
                const { data, error } = await supabase
                    .from('classes')
                    .select('*')
                    .eq('user_id', supabase.auth.user().id);
                
                if (error) {
                    console.error('Error loading classes:', error);
                    return;
                }
                
                const classesContainer = document.getElementById('assignment-list');
                classesContainer.innerHTML = '';
                
                data.forEach(classData => {
                    const classItem = document.createElement('div');
                    classItem.className = 'assignment-item';
                    classItem.innerHTML = `
                        <div>${classData.name} (${classData.code})</div>
                        <div class="delete-btn" data-id="${classData.id}">×</div>
                    `;
                    classesContainer.appendChild(classItem);
                    
                    classItem.querySelector('.delete-btn').addEventListener('click', async () => {
                        await supabase
                            .from('classes')
                            .delete()
                            .eq('id', classData.id)
                            .execute();
                        loadClasses();
                    });
                });
            } catch (error) {
                console.error('Error loading classes:', error);
            }
        }
        
        // Load assignments for a class
        async function loadAssignments(classId) {
            try {
                const { data, error } = await supabase
                    .from('assignments')
                    .select('*')
                    .eq('class_id', classId);
                
                if (error) {
                    console.error('Error loading assignments:', error);
                    return;
                }
                
                const assignmentsContainer = document.getElementById('assignment-list');
                assignmentsContainer.innerHTML = '';
                
                data.forEach(assignment => {
                    const assignmentItem = document.createElement('div');
                    assignmentItem.className = 'assignment-item';
                    assignmentItem.innerHTML = `
                        <div>${assignment.name}</div>
                        <div>${assignment.due_date}</div>
                        <div>${assignment.category}</div>
                        <div class="grade-display">${assignment.score}/${assignment.max_points}</div>
                        <div class="delete-btn" data-id="${assignment.id}">×</div>
                    `;
                    assignmentsContainer.appendChild(assignmentItem);
                    
                    assignmentItem.querySelector('.delete-btn').addEventListener('click', async () => {
                        await supabase
                            .from('assignments')
                            .delete()
                            .eq('id', assignment.id)
                            .execute();
                        loadAssignments(classId);
                    });
                });
            } catch (error) {
                console.error('Error loading assignments:', error);
            }
        }
        
        // Initialize the app
        async function init() {
            // Check if user is logged in
            if (supabase.auth.user()) {
                document.querySelector('.supabase-auth').style.display = 'none';
                loadClasses();
            } else {
                document.querySelector('.supabase-auth').style.display = 'block';
            }
            
            // Handle tab switching
            tabContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('tab')) {
                    tabs.forEach(tab => tab.classList.remove('active'));
                    e.target.classList.add('active');
                    
                    const tabId = e.target.dataset.tab;
                    currentTab = tabId;
                    
                    const tabContent = document.getElementById(`${tabId}-content`);
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.style.display = 'none';
                    });
                    tabContent.style.display = 'block';
                }
            });
            
            // Handle class creation
            classForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const className = document.getElementById('className').value;
                const classCode = document.getElementById('classCode').value;
                const classTeacher = document.getElementById('classTeacher').value;
                const classTerm = document.getElementById('classTerm').value;
                const classYear = document.getElementById('classYear').value;
                const classWeight = document.getElementById('classWeight').value;
                const classDescription = document.getElementById('classDescription').value;
                
                try {
                    const { data, error } = await supabase
                        .from('classes')
                        .insert([
                            {
                                name: className,
                                code: classCode,
                                teacher: classTeacher,
                                term: classTerm,
                                year: classYear,
                                weight: parseInt(classWeight),
                                description: classDescription,
                                user_id: supabase.auth.user().id
                            }
                        ]);
                    
                    if (error) {
                        console.error('Error creating class:', error);
                        alert('Error creating class');
                    } else {
                        classForm.reset();
                        loadClasses();
                    }
                } catch (error) {
                    console.error('Error creating class:', error);
                    alert('Error creating class');
                }
            });
        }
        
        // Initialize the application
        init();
    </script>
</body>
</html>